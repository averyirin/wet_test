$(function(){function a(a,b){a.trigger("click")}$("a.menu").click(function(a){a.preventDefault();var b=$("ul.elgg-menu-site-default");$("ul.elgg-menu-site-default").slideToggle("slow"),$(window).resize(function(){var a=$(window).width();a>768&&b.is(":hidden")&&b.removeAttr("style")})}),$(window).resize(function(){var b=$("#ajax-form .mceEditor"),c=$("#ajax-form").find(".tinymce-toggle-editor");window.innerWidth<990&&b.length>=1?a(c,"hide"):window.innerWidth>=991&&0==b.length&&c.length>=1&&a(c,"show")}),$("form").preventDoubleSubmission(),$(".elgg-body.elgg-main").wetMessages();var b=function(){this.setProperties(),$(this.init)};b.prototype.setProperties=function(){this.ajaxForm=$("#ajax-form"),this.ajaxLoader=elgg.normalize_url("/_graphics/ajax_loader.gif"),this.placeholder=!0,this.filterLink=$("#widget-welcome > ul li"),this.selectedClass=".selected",this.activeClass=".active",this.contentDiv=$(".widget-welcome-content"),this.searchBar=$(".index-search input[type=text]"),this.shareLinks=$(".widget-welcome-content #share-content > a"),this.createLinks=$(".widget-welcome-content #create-content > a"),this.firstClick=!1,that=this},b.prototype.init=function(){that.filterLink.click(that.loadButtons),that.searchBar.focus(that.clearSearch),that.shareLinks.bind("click",{key:"share"},that.loadForm),that.createLinks.bind("click",{key:"create"},that.loadForm)},b.prototype.loadButtons=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1,that.ajaxForm.empty(),that.ajaxForm.append("<form></form>"),$(this).parents("ul").find(that.selectedClass).removeClass(that.selectedClass.substring(1)),$(this).addClass(that.selectedClass.substring(1)),contentLink=$(this).find("a");var b=$(contentLink).attr("href");that.contentDiv.find(that.activeClass).fadeOut(400,"easeOutQuad",function(){$(this).removeClass(that.activeClass.substring(1)),$(this).parent().find("#"+b+"-content").addClass(that.activeClass.substring(1)).hide().fadeIn(400,"easeInQuad")})},b.prototype.clearSearch=function(){that.placeholder&&($(this).val(""),that.placeholder=!1)},b.prototype.loadForm=function(a){event=a,event.preventDefault?event.preventDefault():event.returnValue=!1,that.ajaxForm.empty(),that.ajaxForm.append("<div class='ajax-spinner'><img src='"+that.ajaxLoader+"' alt='Loading Content'/></div>");var b=$(this).attr("href");request="share"==a.data.key?"share_content":"create_content",elgg.get(request+"/"+b.substring(1),{success:function(a,b,c){that.ajaxForm.hide(),that.ajaxForm.children().first().replaceWith(a),that.ajaxForm.fadeIn(600),tinymce.suffix=".min",tinyMCE.init({mode:"specific_textareas",editor_selector:"elgg-input-longtext",theme:"modern",schema:"html5",plugins:["advlist link image charmap print preview hr anchor pagebreak","searchreplace wordcount visualblocks visualchars code fullscreen","insertdatetime media nonbreaking save table contextmenu directionality","emoticons template paste textcolor colorpicker textpattern imagetools jbimages jbvideos"],relative_urls:!1,toolbar1:"insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image",toolbar2:"print preview media | forecolor backcolor emoticons imagetools jbimages jbvideos",image_advtab:!0,width:"100%",extended_valid_elements:"+@[data-options], div",remove_script_host:!1,document_base_url:elgg.config.wwwroot})}})};var c=["all","learner","developer","instructor","trainingmgr"];$("#filter-resources").live("change",function(){var a=this.value;$("div").removeClass("selected");var b=$("div."+c[a]);$(b).addClass("selected")});var d=function(){this.setProperties(),$(this.init)};d.prototype.setProperties=function(){this.activeClass="active",this.activityFeed="div#activity-feed > ul",this.activityFilter=$("ul#activity-filter li"),this.ajaxLoader=elgg.normalize_url("/_graphics/ajax_loader.gif"),activity_widget=this},d.prototype.init=function(){activity_widget.activityFilter.click(activity_widget.filter)},d.prototype.filter=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1,$(this).parent().children().removeClass(activity_widget.activeClass),$(this).addClass(activity_widget.activeClass);var b=$(this),c=b.parent().parent(),d=b.find("a").attr("href"),e=c.find("div#activity-feed > ul"),f=$("div#activity-feed > ul");activity_widget.getRiver(d,e,f)},d.prototype.getRiver=function(a,b,c){b.fadeOut(400,function(){$(this).empty("li"),$(this).append("<div class='ajax-spinner'><img src='"+activity_widget.ajaxLoader+"' alt='Loading Content...' /></div>").fadeIn(100)}),elgg.get("river_activity/"+a.substring(1),{success:function(a,d,e){b.fadeOut(400,function(){a?($(this).replaceWith(a),c.fadeIn(400)):$(this).replaceWith("<ul></ul>")})}})},$("#add-bookmark").click(function(a){a.preventDefault();var b=elgg.get_site_url()+"bookmarks/add/"+elgg.get_logged_in_user_guid()+"?address="+document.URL;$.fancybox({href:b,width:600,height:500,padding:16,titleShow:!1,autoDimensions:!1})}),$("form#ajax-form").live("submit",function(a){$("p.error").remove();var b=$(this).find("input[name=__elgg_token]").val(),c=$(this).find("input[name=__elgg_ts]").val(),d=$(this).find("input[name=title]").val(),e=$(this).find("textarea[name=description]").val(),f=$(this).find("input[name=address]").val(),g=$(this).find("select[name=access_id]").val(),h=$(this).find("input[name=tags]").val(),i=$(this).find("input[name=guid]").val()?$(this).find("input[name=guid]").val():null,j=$(this).find("input[name=container_guid]").val();if(d&&f){var k=elgg.post("action/bookmarks/save",{data:{__elgg_token:b,__elgg_ts:c,title:d,description:e,address:f,access_id:g,tags:h,guid:i,container_guid:j}});k.done(function(a){obj=JSON.parse(a),success=obj.system_messages.success,error=obj.system_messages.error,$.fancybox.close(),success?elgg.system_message(success):error&&elgg.system_message(error)})}else if(d){if(!f){var l=$(this).find("input[name=address]").position();$(this).find("input[name=address]").prevAll("label").append("<p class='error' style='display:inline-block;color:red;margin-left:5px;'>*Please provide an address</p>"),$("#fancybox-content > div").scrollTop(l.top)}}else{var l=$(this).find("input[name=title]").position();$(this).find("input[name=title]").prevAll("label").append("<p class='error' style='display:inline-block;color:red;margin-left:5px;'>*Please provide a title</p>"),$("#fancybox-content > div").scrollTop(l.top)}return!1}),$("#start-tour").click(function(a){a.preventDefault(),joyRideContent=$("#joyRideTipContent"),jQuery.contains(document,joyRideContent[0])?$("#joyRideTipContent").joyride({autoStart:!0,modal:!0,expose:!0,prevButton:!0}):alert("No Training Aid For This Page")}),$("#filter-dropdown > a").click(function(a){a.preventDefault?a.preventDefault():a.returnValue=!1,that=$(this),filterDropdown=$(this).parent().find("ul"),$(filterDropdown).css("width",that.innerWidth()-1),$(filterDropdown).slideToggle()});var e=(new b,new d);$("#activity-feed").length&&e.getRiver("#all",$("div#activity-feed > ul"),$("div#activity-feed > ul"))});